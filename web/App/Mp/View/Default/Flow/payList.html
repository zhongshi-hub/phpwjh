<extend name="Common:base" />
<block name="title">扣费记录</block>
<block name="menu_name">
    扣费记录
</block>
<block name="top_css">
    <link href="__PUBLIC__/amp/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <link href="__PUBLIC__/amp/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <link href="__PUBLIC__/amp/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
    <style>
        .pagination{display:inline-block;padding-left:0;margin:0px 0;border-radius:4px;}
        .pagination>li{display:inline;}
        .pagination>li>a{position:relative;float:left;padding:6px 12px;margin-left:-1px;line-height:1.42857143;color:#337ab7;text-decoration:none;background-color:#fff;border:1px solid #ddd;}
        .pagination>li:first-child>a{margin-left:0;border-top-left-radius:4px;border-bottom-left-radius:4px;}
        .pagination>li:last-child>a{border-top-right-radius:4px;border-bottom-right-radius:4px;}
        .pagination>li>a:focus,.pagination>li>a:hover{z-index:2;color:#23527c;background-color:#eee;border-color:#ddd;}
        .pagination>.active>a,.pagination>.active>a:focus,.pagination>.active>a:hover{z-index:3;color:#fff;cursor:default;background-color:#337ab7;border-color:#337ab7;}
        .pull-right{float:none!important;}
        .pagination>li a:active{box-shadow:inset 0 3px 1px rgba(0,0,0,0.2);}
        .pagination>li a:hover,.pagination>li a:focus{background-color:#fff;border-color:#42a5f5;color:#42a5f5;box-shadow:inset 0 0 1px #42a5f5;z-index:2;transition:border-color,0.3s;}
        .pagination>li>a{color:inherit;border-color:#dcdcdc;transition:border-color,0.3s;}
        .pagination>li:first-child>a{border-top-left-radius:0;border-bottom-left-radius:0;}
        .pagination>li:last-child>a{border-top-right-radius:0;border-bottom-right-radius:0;}
        .pagination>.active>a,.pagination>.active>a:hover,.pagination>.active>a:focus{background-color:#42a5f5;border-color:#42a5f5;}
        .pagination>li>a{background-color:transparent;color:inherit;}
        .pagination>li>a:focus{box-shadow:none;}
        .pagination>li a:hover,.pagination>li a:focus{border-color:#00bcd4;color:#00bcd4;box-shadow:inset 0 0 1px #00bcd4;}
        .pagination>.active>a,.pagination>.active>a:hover,.pagination>.active>a:focus{background-color:#00bcd4;border-color:#00bcd4;}
        .select2-container{vertical-align: super!important;}
    </style>
</block>
<block name="body">
    <div class="row">
        <div class="col-lg-12">
            <div class="card-box">
                <form action="{:U('')}" method="post">
                    <div class="form-row align-items-center">
                        <div class="form-group col-md-2">
                            <label class="col-form-label" for="inlineFormInput">交易单号</label>
                            <input type="text" class="form-control mb-2" name="oid" id="inlineFormInput" placeholder="订单号/官方订单号">
                        </div>
                        <div class="form-group col-md-3">
                            <label class="col-form-label" for="date">日期范围</label>
                            <input type="text" class="form-control mb-2" name="time" id="date" placeholder="交易时间范围">
                        </div>
                        <div class="form-group col-md-3">
                            <label class="col-form-label" for="status">状态</label>
                            <select  id="status" data-placeholder="请选择..."   class="form-control mb-2 select2" name="status">
                                <option value="1" >支付成功</option>
                                <option value="3" >支付中/失败</option>
                                <option value="2" >交易已退款</option>
                                <option value="all" >全部状态</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-info mb-2" style="margin-top: 20px">搜索</button>
                    </div>
                </form>
                <table class="table text-center">
                    <thead>
                    <tr>
                        <th>订单号</th>
                        <th>订单金额</th>
                        <th>扣费金额</th>
                        <th>扣费日期</th>
                        <th>扣费类型</th>
                        <th>扣费状态</th>
                    </tr>
                    </thead>
                    <tbody>
                    <foreach name="data" item="v">
                        <tr>
                            <td>{$v.oid}</td>
                            <td>{$v.oid_total}元</td>
                            <td>{$v.total}元</td>
                            <td>{$v.time|date="Y-m-d H:i:s",###}</td>
                            <td>{$v.pay_type}</td>
                            <td>
                                <if condition="$v['status'] eq 1">
                                    <span class="badge label-table badge-success">成功</span>
                                    <elseif condition="$v['status'] eq 2"/>
                                    <span class="badge label-table badge-dark">已退款</span>
                                    <else/>
                                    <span class="badge label-table badge-secondary">失败/交易中</span>
                                </if>
                            </td>
                        </tr>
                    </foreach>
                    </tbody>
                </table>
                <div  style="text-align: right">
                    {$page}
                </div>
            </div>

        </div>
    </div>

    <!-- Modal -->
    <div id="custom-modal" class="modal-demo">
        <button type="button" class="close" onclick="Custombox.close();">
            <span>&times;</span><span class="sr-only">关闭</span>
        </button>
        <h4 class="custom-modal-title">报警手机号设置</h4>
        <div class="custom-modal-text">
            <div class="alert alert-info">此手机号码用于接收流量报警短信，短信提醒每天最多发送3次。</div>
            <form class="form-horizontal" action="#">
                <div class="form-group m-b-25">
                    <div class="col-12">
                        <label for="phone">手机号码</label>
                        <input class="form-control" type="text" id="phone" required="" placeholder="留空则不发送报警信息">
                    </div>
                </div>
                <div class="form-group account-btn text-center m-t-10">
                    <div class="col-12">
                        <button class="btn w-lg btn-rounded btn-custom waves-effect waves-light" type="submit">保存</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</block>
<block name="footer_js">
    <script src="__PUBLIC__/amp/plugins/moment/moment.js"></script>
    <script src="__PUBLIC__/amp/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
    <script src="__PUBLIC__/amp/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script src="__PUBLIC__/amp/plugins/select2/js/select2.min.js" type="text/javascript"></script>
    <script>
        jQuery(document).ready(function () {
            $(".select2").select2();
            $('#date').daterangepicker({
                format: 'MM/DD/YYYY',
                startDate:moment().startOf('month'),
                endDate: moment().endOf('month'),
                minDate: '01/01/2017',
                maxDate: '12/31/2021',
                dateLimit: {
                    days: 31
                },
                showDropdowns: true,
                showWeekNumbers: false,
                timePicker: false,
                timePickerIncrement: 1,
                timePicker12Hour: true,
                ranges: {
                    '今日': [moment(), moment()],
                    '昨日': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    '近7天': [moment().subtract(6, 'days'), moment()],
                    '近30天': [moment().subtract(29, 'days'), moment()],
                    '本月': [moment().startOf('month'), moment().endOf('month')],
                    '上月': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                opens: 'left',
                drops: 'down',
                buttonClasses: ['btn', 'btn-sm'],
                applyClass: 'btn-success',
                cancelClass: 'btn-light',
                separator: ' to ',
                locale: {
                    applyLabel: '确定',
                    cancelLabel: '取消',
                    fromLabel: '起始时间',
                    toLabel: '结束时间',
                    customRangeLabel: '自定义',
                    daysOfWeek: ["日", "一", "二", "三", "四", "五", "六"],
                    monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
                    firstDay: 1
                }
            }, function (start, end, label) {
                //$('#date span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            });
        })
    </script>
</block>
