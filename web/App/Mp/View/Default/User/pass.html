<extend name="Common:base" />
<block name="top_css">
    <!-- Toastr css -->
    <link href="__PUBLIC__/amp/plugins/jquery-toastr/jquery.toast.min.css" rel="stylesheet" />
</block>
<block name="body">
    <div class="row">
        <div class="col-md-12">
            <div class="card-box">
                <h4 class="m-t-0 m-b-30 header-title">登录密码修改</h4>
                <form role="form" action="{:U('')}">
                    <div class="form-group">
                        <label for="pass">旧密码</label>
                        <input type="text" class="form-control" name="pass" id="pass" aria-describedby="emailHelp" placeholder="请输入旧密码" required>
                        <small id="emailHelp" class="form-text text-muted">请输入您的旧密码进行新密码修改</small>
                    </div>
                    <div class="form-group">
                        <label for="new_pass">新密码</label>
                        <input type="text" class="form-control" name="new_pass" id="new_pass" placeholder="请输入新密码" required>
                    </div>
                    <div class="form-group">
                        <label for="new_pass1">确认新密码</label>
                        <input type="text" class="form-control" name="new_pass1" id="new_pass1" placeholder="请输入确认新密码" required>
                    </div>
                    <button type="submit" class="btn btn-primary">提 交</button>
                </form>
            </div>
        </div>
    </div>

</block>

<block name="footer_js">
<script src="__PUBLIC__/amp/plugins/jquery-toastr/jquery.toast.min.js" type="text/javascript"></script>
<script>
    $(function () {
        $("form").submit(function (e) {
            e.preventDefault();
            var ajax_data = $(this).serialize();
            var actionurl = $(this).attr("action");
            $.post(actionurl, ajax_data, function (data) {
                if (data.status === 1) {
                    $.toast({
                        heading: '温馨提示!',
                        text: data.info,
                        position: 'top-right',
                        loaderBg: '#5ba035',
                        icon: 'success',
                        hideAfter: 3000,
                        stack: 1
                    });
                    setTimeout(function () {
                        window.location.href='/mp/login/index'; //修改密码后重新登录
                    }, 3000);
                }
                else {
                    $.toast({
                        heading: '温馨提示',
                        text: data.info,
                        position: 'top-right',
                        loaderBg: '#bf441d',
                        icon: 'error',
                        hideAfter: 3000,
                        stack: 1
                    });
                }
            }, 'json');
        });
    });
</script>
</block>