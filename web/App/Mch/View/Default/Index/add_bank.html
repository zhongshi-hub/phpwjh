<!DOCTYPE html>
<html style="height: auto">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>添加新卡</title>
    <link rel="stylesheet" href="__YUI__/css/ydui.css"/>
    <link rel="stylesheet" href="__YUI__/css/my-app.css"/>
    <style>
        input::-webkit-input-placeholder {
            font-size: 13px;
        }
    </style>
</head>
<body>
<section class="g-flexview">
    <section class="g-scrollview" style="margin-bottom: 60px">
        <aside class="demo-tip">
            新卡只允许添加本人名下信用卡 不支持借记卡
        </aside>
        <form action="" method="post">
            <div class="mui-input-group">
                <div class="mui-input-row">
                    <label>开户姓名：</label>
                    <input class="mui-input-clear" type="text" value="{$seller.mch_card_name}" name="name" readonly>
                </div>
                <div class="mui-input-row">
                    <label>身份证号：</label>
                    <input class="mui-input-clear" type="text" value="{$seller.mch_card_id}" name="cert" readonly>
                </div>
                <div class="mui-input-row">
                    <label>开户银行：</label>
                    <input id="bank" placeholder="请选择开户银行" class="mui-input-clear" type="text" name="bank_name"
                           readonly>
                    <input id="bank_val" type="hidden" name="bank">
                </div>
                <div class="mui-input-row">
                    <label>信用卡号：</label>
                    <input class="mui-input-clear" placeholder="请输入银行信用卡号" autocomplete="off" type="tel" name="card"
                           required>
                </div>
                <div class="mui-input-row">
                    <label>手机号码：</label>
                    <input class="mui-input-clear" placeholder="请输入预留手机号" autocomplete="off" type="tel" name="phone"
                           required>
                </div>
                <div class="mui-input-row">
                    <label>有效期限：</label>
                    <input class="mui-input-clear" id="date" placeholder="请输入信用卡有效期" autocomplete="off" type="text"
                           name="date" readonly>
                </div>
                <div class="mui-input-row">
                    <label>CVN码：</label>
                    <input class="mui-input-clear" placeholder="请输入信用卡CVN(卡背面后三位) " autocomplete="off" type="tel"
                           name="cvn" required>
                </div>

            </div>

            <div class="mui-content-padded" style="margin-top: 20px">
                <button type="submit" class="mui-btn mui-btn-block mui-btn-success">
                    提 交
                </button>
            </div>
        </form>
    </section>
</section>
<footer class="m-tabbar tabbar-fixed">
    <a href="{:U('Index/index')}" class="tabbar-item tabbar-active">
                <span class="tabbar-icon">
                    <i class="icon-home-outline"></i>
                </span>
        <span class="tabbar-txt">主页</span>
    </a>
    <a href="{:U('Index/order')}" class="tabbar-item">
                <span class="tabbar-icon">
                    <i class="icon-order"></i>
                    <span class="tabbar-dot"></span>
                </span>
        <span class="tabbar-txt">流水</span>
    </a>
    <a href="{:U('Index/my')}" class="tabbar-item">
                <span class="tabbar-icon">
                    <i class="icon-ucenter-outline"></i>
                </span>
        <span class="tabbar-txt">我的</span>
    </a>
</footer>
<link rel="stylesheet" href="__PUBLIC__/mui/css/mui.min.css"/>
<link rel="stylesheet" href="__PUBLIC__/mui/css/mui.picker.min.css"/>
<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="__YUI__/js/ydui.js"></script>
<script src="__YUI__/js/ydui.flexible.js"></script>
<script src="__PUBLIC__/mui/js/mui.min.js"></script>
<script src="__PUBLIC__/mui/js/mui.picker.min.js"></script>
<script>
    $('#bank').click(function () {
        var picker = new mui.PopPicker();
        picker.setData({$bank});
        picker.show(function (selectItems) {
            $('#bank').val(selectItems[0].text);
            $('#bank_val').val(selectItems[0].value);
        })
    });
    $('#date').click(function () {
        var dtPicker = new mui.DtPicker({
            type: "month",
            endDate: new Date(2111, 11)
        });
        dtPicker.show(function (selectItems) {
            $('#date').val(selectItems.y.value + selectItems.m.value);
        })
    });

    $(function() {
        $("form").submit(function (e) {
            e.preventDefault(); //阻止自动提交表单
            var _bank=$('#bank_val').val();
            var _date=$('#date').val();
            var telNo = $('[name="phone"]').val();
            var telReg = !!telNo.match(/^1[3|4|5|7|8][0-9]{9}$/);
            //效验数据
            if(_bank == ""){
                show('请选择开户行');
            }else if(_date == ""){
                show('请选择信用卡有效期限');
            }else if (telNo == "") {
                show('请输入手机号');
            }else if (telReg == false) {
                show('请输入正确的手机号');
            }else {
                var ajax_data = $(this).serialize();
                var actionurl = $(this).attr("action");
                $.post(actionurl, ajax_data, function (data) {
                    if (data.status == 1) {
                        mui.alert(data.info,'提示','知道了',function () {
                            window.location.href = data.url
                        });
                    }
                    else {
                        show(data.info);
                    }
                }, 'json');
            }
        });
    });

    function show(data) {
        mui.alert(data,'提示','知道了');
        return false;
    }
</script>

</body>

</html>